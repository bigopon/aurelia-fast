import{IObserverLocator as t}from"@aurelia/runtime";import{ComputedWatcher as e}from"@aurelia/runtime-html";class s{constructor(t,e,s){this.type=t,this.attrs=e,this.children=s}}class r{constructor(t,e,s){this.type=t,this.attrs=e,this.children=s}}class n{constructor(t,e){this.type=t,this.expression=e}get __te(){return!0}compile(t,e,s){return new i(this.type,this.expression)}}class i{constructor(t,e){this.type=t,this.expression=e}get __be(){return!0}create(t){return new o(t,this.type,this.expression)}}class o{constructor(t,e,s){this.target=t,this.type=e,this.expression=s}bind(t){this.scope=t,this.target.addEventListener(this.type,this)}unbind(){this.scope=void 0,this.target.removeEventListener(this.type,this)}handleEvent(t){this.expression.call(void 0,this.scope.source,t,this.scope)}}class c{constructor(t){this.type=t}get __te(){return!0}compile(t,e,s){return new h(this.type)}}class h{constructor(t){this.type=t}get __be(){return!0}create(t){return new l(t,this.type)}}class a{constructor(t){this.type=t}get __te(){return!0}compile(t,e,s){return new u(this.type)}}class u{constructor(t){this.type=t}get __be(){return!0}create(t){return new l(t.$au.viewModel,this.type)}}class l{constructor(t,e){this.target=t,this.key=e}bind(t){this.scope=t,t.source[this.key]=this.target}unbind(){this.scope.source[this.key]===this.target&&(this.scope.source[this.key]=null)}}class p{constructor(t,e){this.toView=t,this.fromView=e}get __te(){return!0}compile(t,e,s){return new w(e,[this.toView,this.fromView],s)}}class d{constructor(t){this.expressions=t}get __be(){return!0}create(t){if(!t)throw new Error("Invalid usage of prop binding expression. Example: prop=${x => x.value}");throw t.$au?.viewModel,new Error("not implemented")}}class f{constructor(t,e,s){this.key=t,this.expression=e,this.context=s}get __be(){return!0}create(e){const s=e.$au?.viewModel;return s&&this.key in s?new g(this.key,s,this.expression,this.context.get(t)):new g(this.key,e,this.expression,this.context.get(t))}}class w{constructor(t,e,s){this.key=t,this.expressions=e,this.context=s}get __be(){return!0}create(e){return new y(this.key,e,this.expressions,this.context.get(t))}}class g{constructor(t,e,s,r){this.key=t,this.target=e,this.expression=s,this.observerLocator=r}bind(t){new e(t.source,this.observerLocator,this.expression,(t=>{this.target[this.key]=t}),!0).$bind(),this.target[this.key]=this.expression(t.source,t,t)}unbind(){throw new Error("Method not implemented.")}}class y{constructor(t,e,s,r){this.key=t,this.target=e,this.expressions=s,this.observerLocator=r}bind(t){const s=this.observerLocator.getObserver(this.target,this.key);s.setValue(this.expressions[0](t.source,t,t),0,this.target,this.key),s.subscribe({handleChange:e=>{this.expressions[1](e,t.source,null,t)}});new e(t.source,this.observerLocator,this.expressions[0],(t=>{this.target[this.key]!==t&&(this.target[this.key]=t)}),!0).$bind()}unbind(){throw new Error("Method not implemented.")}}function b(t){return!0===t?.__te}class m{constructor(t){this.nodes=t}compile(t){return new x(this.nodes.map((function e(s){return new r(s.type,null===s.attrs?[]:Object.entries(s.attrs).map((([e,r])=>{const n=function(t){return/^a__\d+$/.test(t)}(e);switch(typeof r){case"object":if(null===r)throw new Error("Expression cannot be null");if(b(r))return r.compile(s,n?null:e,t);if(!(r instanceof Array))return new d(Object.entries(r).reduce(((e,[r,i])=>(b(i)?i=i.compile(s,n?null:r,t):"function"==typeof i&&(i=new f(r,i,t)),e[r]=i,e)),{}));{if(n)throw new Error("Array syntax cannot be used without target prop");const[s,i]=r;if("function"!=typeof s&&"function"!=typeof i)throw new Error("Binding must be at least have 1 direction");if(s&&i)return new w(e,r,t)}case"function":if(n)throw new Error(`No key for lambda: ${r.toString()}`);return new f(e,r,t)}return{name:e,value:r}})),s.children.map((t=>"string"==typeof t?t:e(t))))})))}}class x{constructor(t){this.nodes=t}render(){const t=document.createDocumentFragment(),e=[];function s(t,r){const n=r.appendChild(document.createElement("string"==typeof t.type?t.type:t.type.name));t.attrs.forEach((t=>{if(!0===t?.__be)e.push(t.create(n));else{const{name:e,value:s}=t;/^data-|aria-|\w+:\w+/.test(e)?n.setAttribute(e,s):n[e]=s}})),t.children.forEach((t=>"string"==typeof t?n.appendChild(document.createTextNode(t)):s(t,n)))}return this.nodes.forEach((e=>s(e,t))),new _(t,e)}}class _{constructor(t,e){this.fragment=t,this.bindings=e,t.hasChildNodes()&&(this.firstChild=t.firstChild,this.lastChild=t.lastChild)}insertBefore(t){t.parentNode.insertBefore(this.fragment,t)}appendTo(t){t.appendChild(this.fragment)}remove(){let t,e=this.firstChild;for(;null!=e&&e!==this.lastChild;)t=e,e=e.nextSibling,this.fragment.appendChild(t)}bind(t){this.bindings.forEach((e=>e.bind(t)))}unbind(){this.bindings.forEach((t=>t.unbind()))}}function v(t,e){return new n(t,e)}function k(t){return new c(t)}function E(t){return new a(t)}function C(t,e){return new p(t,e)}function $(t,...e){return new m(M.call(L,t,...e))}function L(t,e,...r){return new s(t,e,r)}const M=function(t){const e=arguments,s=this,r=new WeakMap,n=t=>{const e=(r.get(t)??0)+1;return r.set(t,e),e-1};let i,o,c=1,h="",a="",u=[0];const l=t=>{1===c&&(t||(h=h.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?u.push(t?e[t]:h):3===c&&(t||h)?(u[1]=t?e[t]:h,c=2):2===c&&"..."===h&&t?u[2]=Object.assign(u[2]??(u[2]={}),e[t]):2===c&&h&&!t?(u[2]??(u[2]={}))[h]=!0:2===c&&!h&&t?(u[2]??(u[2]={}))[`a__${n(u[2])}`]=e[t]:c>=5&&(5===c?((u[2]=u[2]||{})[o]=t?h?h+e[t]:e[t]:h,c=6):(t||h)&&(u[2][o]+=t?h+e[t]:h)),h=""};for(let e=0;e<t.length;e++){e&&(1===c&&l(),l(e));for(let r=0;r<t[e].length;r++)i=t[e][r],1===c?"<"===i?(l(),u=[u,"",null],c=3):h+=i:4===c?"--"===h&&">"===i?(c=1,h=""):h=i+h[0]:a?i===a?a="":h+=i:'"'===i||"'"===i?a=i:">"===i?(l(),c=1):c&&("="===i?(c=5,o=h,h=""):"/"===i&&(c<5||">"===t[e][r+1])?(l(),3===c&&(u=u[0]),c=u,(u=u[0]).push(s.apply(null,c.slice(1))),c=0):" "===i||"\t"===i||"\n"===i||"\r"===i?(l(),c=2):h+=i),3===c&&"!--"===h&&(c=4,u=u[0])}return l(),u.length>2?u.slice(1):u[1]};export{v as On,k as Ref,C as TwoWay,E as ViewModelRef,$ as html};
//# sourceMappingURL=index.min.js.map
